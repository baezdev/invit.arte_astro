---
import TemplateCard from "../components/TemplateCard.astro";
import { supabase } from "../config/supabase.config";
import Layout from "../layouts/Layout.astro";
import SubPageLayout from "../layouts/SubPageLayout.astro";

const { data } = await supabase.from("designs").select().order("name");
const templates = data;
---

<Layout title="InvitðŸ’›Arte (DiseÃ±os)">
  <SubPageLayout title="Plantillas Disponibles">
    <main>
      <section class="sTarjetas">
        <div class="contenedor">
          <div class="contenedorP contPlantillas">
            {
              templates.map((template, i) => (
                <TemplateCard id={i + 1} {...template} />
              ))
            }
            <section class="imagen-light">
              <img src="/images/cerrar.svg" alt="" class="close" />
              <img src="" alt="" class="agregarImg" />
            </section>
          </div>
        </div>
      </section>
    </main>
  </SubPageLayout>
</Layout>
<script>
  const imagenes = document.querySelectorAll(".plantilla");
  const imagenesLight = document.querySelector(".agregarImg");
  const contenedorLight = document.querySelector(".imagen-light");
  const flecha = document.querySelector(".button__top");

  imagenes.forEach((imagen) => {
    imagen.addEventListener("click", () => {
      aparecerImg(imagen.getAttribute("src"));
    });
  });

  contenedorLight.addEventListener("click", (e) => {
    if (e.target !== imagenesLight) {
      contenedorLight.classList.toggle("show");
      imagenesLight.classList.toggle("showImage");
    }
  });

  const aparecerImg = (imagen) => {
    imagenesLight.src = imagen;
    contenedorLight.classList.toggle("show");
    imagenesLight.classList.toggle("showImage");
  };
</script>
